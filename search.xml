<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>[水] Matrix-Tree 与 拓展Cayley 公式</title>
    <url>/%5B%E6%B0%B4%5D%20Matrix-Tree%20%E4%B8%8E%20%E6%8B%93%E5%B1%95Cayley%20%E5%85%AC%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="水-matrix-tree-与-拓展cayley-公式">[水] Matrix-Tree 与
拓展Cayley 公式</h1>
<h2 id="问题描述">问题描述</h2>
<p>对于一棵<span
class="math inline">\(n\)</span>个节点有标号无根树，已经被若干条边分成了大小分别为<span
class="math inline">\(a_1,a_2,\cdots, a_m\)</span>的若干连通块</p>
<p>求连成一棵树的方案数</p>
<p><br></p>
<span id="more"></span>
<h2 id="用matrix-tree定理证明">用Matrix-Tree定理证明</h2>
<p>将每一个连通块压在一起考虑，此时有连通块<span
class="math inline">\(a_i,a_j\)</span>之间的边数即为<span
class="math inline">\(a_i\cdot a_j\)</span></p>
<p>那么有矩阵如下</p>
<p><span class="math inline">\(\left(\begin{array}{ccccc}
a_1(n-a_1)&amp; -a_1a_2 &amp; -a_1a_3 &amp; \cdots &amp; -a_1a_m\\
-a_2a_1&amp; a_2(n-a_2) &amp; -a_2a_3 &amp; \cdots &amp; -a_2a_m \\
&amp; &amp; \ddots &amp; &amp; \\ -a_{m-1}a_1 &amp; -a_{m-1} a_2 &amp;
-a_{m-1}a_3 &amp; \cdots &amp; -a_{m-1}a_m\\ -a_{m}a_1 &amp; -a_{m} a_2
&amp; -a_{m}a_3 &amp; \cdots &amp;
a_m(n-a_m)\end{array}\right)\)</span>​​</p>
<p>去掉最后一行，最后一列，得到</p>
<p><span class="math inline">\(\left(\begin{array}{ccccc}
a_1(n-a_1)&amp; -a_1a_2 &amp; -a_1a_3 &amp; \cdots &amp; -a_1a_{m-1}\\
-a_2a_1&amp; a_2(n-a_2) &amp; -a_2a_3 &amp; \cdots &amp; -a_2a_{m-1} \\
&amp; &amp; \ddots &amp; &amp; \\ -a_{m-1}a_1 &amp; -a_{m-1} a_2 &amp;
-a_{m-1}a_3 &amp; \cdots &amp;
a_{m-1}(n-a_{m-1})\end{array}\right)\)</span>​</p>
<p>接下来要算其行列式，首先化简矩阵，第<span class="math inline">\(i
(i&gt;1)\)</span>行减去第<span class="math inline">\(i-1\)</span>行<span
class="math inline">\(\times \frac{a_i}{a_{i-1}}\)</span></p>
<p>得到新的矩阵</p>
<p><span class="math inline">\(\left(\begin{array}{cccccc}
a_1(n-a_1)&amp; -a_1a_2 &amp; -a_1a_3 &amp; \cdots &amp; -a_1a_{m-2}
&amp; -a_1a_{m-1}\\ -a_2n&amp; a_2n &amp; 0 &amp; \cdots &amp; 0&amp; 0
\\ &amp; &amp; &amp; \ddots &amp; &amp; \\ 0 &amp; 0 &amp; 0 &amp;
\cdots &amp; -a_{m-1}n &amp; a_{m-1}n\end{array}\right)\)</span>​</p>
<p>此时，除了第一行以外的每一行，只在<span
class="math inline">\(i-1,i\)</span>处有值，这样的特殊矩阵，带入行列式的表达式</p>
<p><span class="math inline">\(\displaystyle \det(A)=\sum_{\text{p is a
permutation}} (-1)^{N(p)} \prod A_{i,p_i}\)</span></p>
<p>有值的<span class="math inline">\(p\)</span>只有<span
class="math inline">\(n\)</span>个，分成两类</p>
<p>1.<span class="math inline">\(p_i=i,N(p)=0\)</span>，<span
class="math inline">\(\prod A_{i,p_i}=(n-a_1)n^{m-2} \prod_{i&lt;m}
a_i\)</span></p>
<p>2.<span
class="math inline">\(p_1=q(q&gt;1),p_j=\left\{\begin{aligned} j-1
&amp;&amp; 2\leq j\leq q\\ j &amp;&amp;
q&lt;j\end{aligned}\right.\)</span></p>
<p><span class="math inline">\(\prod A_{i,p_i}=(-1)^{q-1} (-n)^{q}
n^{m-1-q}a_q \prod_{i&lt;m} a_i=-n^{m-2} a_q\prod_{i&lt;m}
a_i\)</span></p>
<p>则<span class="math inline">\(\det=(n-a_1-a_2-\cdots-a_{m-1})n^{m-2}
\prod_{i&lt;m} a_i=a_mn^{m-2} \prod_{i&lt;m} a_i=n^{m-2} \prod
a_i\)</span></p>
<p>即方案数为<span class="math inline">\(n^{m-2} \prod a_i\)</span></p>
]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>矩阵</tag>
      </tags>
  </entry>
</search>
